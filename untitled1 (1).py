# -*- coding: utf-8 -*-
"""Untitled1.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1eC1QSheguQ5S7LcbcI3twhtozHqUSbTf
"""

# âœ… Ø¥Ø²Ø§Ù„Ø© sympy Ù†Ù‡Ø§Ø¦ÙŠØ§Ù‹
!pip uninstall sympy -y

# âœ… ØªØ«Ø¨ÙŠØª Ø¥ØµØ¯Ø§Ø± Ù…Ø­Ø¯Ø¯ ÙŠØ¹Ù…Ù„ Ø¨Ø¯ÙˆÙ† Ù…Ø´Ø§ÙƒÙ„
!pip install sympy==1.12

# âœ… Ø¥Ø¹Ø§Ø¯Ø© ØªØ«Ø¨ÙŠØª transformers Ùˆ gradio
!pip install --upgrade transformers gradio -q

from transformers import pipeline
import gradio as gr

# âœ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ (Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… PyTorch Ù„ØªØ¬Ù†Ø¨ ØªØ¹Ø§Ø±Ø¶Ø§Øª)
generator = pipeline("text-generation", model="aubmindlab/aragpt2-base")

# âœ… Ø¯Ø§Ù„Ø© Ø§Ù„ØªØ®Ù…ÙŠÙ†
def guess_entity(desc1, desc2, desc3):
    clues = f"{desc1}, {desc2}, {desc3}"
    prompt = f"Ø£Ù†Ø§ Ù„Ø¹Ø¨Ø© Ù…Ù† Ø£Ù†Ø§. ØªÙ… Ø¥Ø¹Ø·Ø§Ø¦ÙŠ Ø§Ù„Ø£ÙˆØµØ§Ù Ø§Ù„ØªØ§Ù„ÙŠØ©: {clues}. Ù…Ù† Ø£ÙƒÙˆÙ†ØŸ"
    print("ğŸš€ Prompt:", prompt)  # Ù„Ù…Ø³Ø§Ø¹Ø¯ØªÙƒ ÙÙŠ Ø§Ù„ØªØµØ­ÙŠØ­ Ø¥Ø°Ø§ Ø§Ø­ØªØ¬Øª
    try:
        result = generator(prompt, max_new_tokens=50, num_return_sequences=1)[0]["generated_text"]
        guess = result[len(prompt):].strip().split('\n')[0]
        return f"ğŸ¤– ØªØ®Ù…ÙŠÙ†ÙŠ Ù‡Ùˆ: {guess}"
    except Exception as e:
        return f"âŒ Ø­ØµÙ„ Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„ØªØ®Ù…Ù‘ÙŠÙ†: {str(e)}"

# âœ… ØªØµÙ…ÙŠÙ… Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
interface = gr.Interface(
    fn=guess_entity,
    inputs=[
        gr.Textbox(label="ğŸ§© Ø§Ù„ÙˆØµÙ Ø§Ù„Ø£ÙˆÙ„"),
        gr.Textbox(label="ğŸ§© Ø§Ù„ÙˆØµÙ Ø§Ù„Ø«Ø§Ù†ÙŠ"),
        gr.Textbox(label="ğŸ§© Ø§Ù„ÙˆØµÙ Ø§Ù„Ø«Ø§Ù„Ø«")
    ],
    outputs=gr.Textbox(label="ğŸ” ØªØ®Ù…ÙŠÙ† Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ"),
    title="ğŸ­ Ù„Ø¹Ø¨Ø© Ù…Ù† Ø£Ù†Ø§ØŸ",
    description="ğŸ˜Š Ø§ÙƒØªØ¨ 3 Ø£ÙˆØµØ§Ù ÙˆØ³Ø£Ø­Ø§ÙˆÙ„ Ø£Ù† Ø£Ø®Ù…Ù‘Ù† Ù…Ù† ØªÙ‚ØµØ¯! Ø¬Ø±Ø¨Ù†ÙŠ"
)

# âœ… ØªØ´ØºÙŠÙ„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
interface.launch(share=True)